{% extends "base.html" %}
{% load static %}

{% block title %}Criar Oportunidade{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/criar_oportunidade.css' %}">
{% endblock %}

{% block content %}
<div class="opportunity-page">
    <header class="opportunity-header">
        <div class="opportunity-back-button">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                <path d="M15 6L9 12L15 18" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>

        <div class="opportunity-header-title">Criar Oportunidade</div>
        <div class="opportunity-header-subtitle">Conecte alunos com oportunidades acad√™micas criadas por voc√™</div>
    </header>

    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %} 

        <div class="form-group">
            <label for="{{ form.titulo.id_for_label }}">T√≠tulo <span class="required">*</span></label>
            {{ form.titulo }} 
            {% for error in form.titulo.errors %}
                <span class="error-message">{{ error }}</span>
            {% endfor %}
            <span class="char-counter">0/100</span>
        </div>

        <div class="form-group">
            <label class="opportunity-label" for="{{ form.descricao.id_for_label }}">Descri√ß√£o <span class="required">*</span></label>
            {{ form.descricao }}
            {% for error in form.descricao.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
            <span class="char-counter">0/5000</span>
        </div>
        
        <div class="form-group">
            <label class="opportunity-label" for="{{ form.foto.id_for_label }}">Imagem de Capa (Opcional)</label>
            {{ form.foto }}
            {% for error in form.foto.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
            <small style="color:#666; font-size:12px;">Se nenhuma imagem for enviada, um placeholder ser√° exibido.</small>
        </div>

        <div class="form-group">
            <label class="opportunity-label" for="{{ form.tipo.id_for_label }}">Tipo de atividade <span class="required">*</span></label>
            {{ form.tipo }} 
            {% for error in form.tipo.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
            
            <div class="opportunity-activity-group" style="margin-top: 8px;">
                 <div class="opportunity-activity-btn">Monitoria Acad√™mica</div>
                 <div class="opportunity-activity-btn">Inicia√ß√£o Cient√≠fica</div>
                 <div class="opportunity-activity-btn">Est√°gio</div>
                 <div class="opportunity-activity-btn">Laborat√≥rio de Pesquisa</div>
            </div>
        </div>

        <div class="form-group">
            <label class="opportunity-label" for="{{ form.local.id_for_label }}">Local de realiza√ß√£o da atividade <span class="required">*</span></label>
            {{ form.local }}
            {% for error in form.local.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
        </div>
        
        <div class="form-group">
            <label class="opportunity-label" for="{{ form.cursos_elegiveis.id_for_label }}">Cursos eleg√≠veis para participa√ß√£o <span class="required">*</span></label>
            {{ form.cursos_elegiveis }}
            {% for error in form.cursos_elegiveis.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
        </div>
        
        <div class="form-group">
            <label class="opportunity-label" for="{{ form.carga_horaria.id_for_label }}">Carga hor√°ria <span class="required">*</span></label>
            {{ form.carga_horaria }}
            {% for error in form.carga_horaria.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
        </div>
        
        <div class="form-group">
            <label class="opportunity-label" for="{{ form.num_vagas.id_for_label }}">N√∫mero de vagas dispon√≠veis <span class="required">*</span></label>
            {{ form.num_vagas }}
            {% for error in form.num_vagas.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
        </div>

        <div class="form-group">
            <label class="opportunity-label" for="{{ form.horas_complementares.id_for_label }}">N√∫mero de horas complementares <span class="required">*</span></label>
            {{ form.horas_complementares }}
            {% for error in form.horas_complementares.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
        </div>

        <div class="form-group">
            <label class="opportunity-label" for="{{ form.remuneracao.id_for_label }}">Remuneracao <span class="required">*</span></label>
            {{ form.remuneracao }}
            {% for error in form.remuneracao.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
        </div>

        <div class="form-group">
            <label class="opportunity-label" for="{{ form.processo_seletivo.id_for_label }}">Processo seletivo <span class="required">*</span></label>
            {{ form.processo_seletivo }}
            {% for error in form.processo_seletivo.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
        </div>

        <div class="form-group">
            <label class="opportunity-label" for="{{ form.data_encerramento.id_for_label }}">Data de encerramento do processo seletivo <span class="required">*</span></label>
            {{ form.data_encerramento }}
            {% for error in form.data_encerramento.errors %}<span class="error-message">{{ error }}</span>{% endfor %}
            </div>

        <button type="submit" class="opportunity-confirm">Confirmar</button>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // üí° OBS: O JavaScript aqui s√≥ lida com a sele√ß√£o visual dos bot√µes.
    
    const activityGroup = document.querySelector('.opportunity-activity-group');
    const buttons = activityGroup ? activityGroup.querySelectorAll('.opportunity-activity-btn') : [];

    // L√≥gica visual para selecionar o bot√£o
    buttons.forEach(btn => {
        btn.addEventListener('click', () => {
            buttons.forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            
            // Exemplo de como voc√™ teria que definir o valor no campo real do Django:
            // document.getElementById('id_tipo').value = 'MON'; // O valor real do choice (MON, IC, EST, etc.)
        });
    });

    // Adicione aqui a l√≥gica de JavaScript para os contadores de caracteres (char-counter), se necess√°rio.
    const charCounterSetup = (textareaId, counterClass, maxLength) => {
        const textarea = document.getElementById(textareaId);
        const counter = textarea ? textarea.closest('.form-group').querySelector(counterClass) : null;

        if (textarea && counter) {
            const updateCounter = () => {
                counter.textContent = `${textarea.value.length}/${maxLength}`;
            };
            textarea.addEventListener('input', updateCounter);
            updateCounter(); // Initial count
        }
    };

    // Exemplo para o t√≠tulo e descri√ß√£o:
    charCounterSetup('id_titulo', '.char-counter', 100);
    charCounterSetup('id_descricao', '.char-counter', 5000);
</script>
<style>
/* Estilo b√°sico para exibir os erros do Django no template */
.error-message {
    color: #DC2626; /* Cor vermelha para erros */
    font-size: 13px;
    display: block;
    margin-top: 4px;
}

/* Adicionando estilo para o campo de data, que agora √© um input type="date" */
input[type="date"] {
    width: 100%;
    padding: 10px;
    border: 1px solid #D1D5DB;
    border-radius: 6px;
    font-size: 16px;
}
/* Estilo para o campo select do tipo de oportunidade */
select {
    width: 100%;
    padding: 10px;
    border: 1px solid #D1D5DB;
    border-radius: 6px;
    font-size: 16px;
    background-color: #FFFFFF;
}

/* Estilo para os inputs e textareas do forms.py */
.opportunity-input, .opportunity-input[type="number"], input[type="file"] {
    width: 100%;
    padding: 12px;
    border: 1px solid #D1D5DB;
    border-radius: 6px;
    font-size: 16px;
    font-family: inherit;
    background-color: #FFFFFF;
}

/* Ajuste espec√≠fico para o input de arquivo para ficar bonito */
input[type="file"] {
    padding: 9px; /* Ajuste leve no padding */
}
</style>
{% endblock %}