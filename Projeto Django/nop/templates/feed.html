{% extends 'base.html' %}
{% load static %}

{% block title %}Feed | NOP{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/filtros.css' %}" />
<link rel="stylesheet" href="{% static 'css/feed.css' %}" />
{% endblock %}

{% block content %}
<nav class="barra-principal" role="navigation" aria-label="Menu principal">
    <div class="filtros-area">
        <div class="filtros-toggle" id="filtrosToggle">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="4" y1="12" x2="20" y2="12"></line>
                <line x1="4" y1="6" x2="20" y2="6"></line>
                <line x1="4" y1="18" x2="20" y2="18"></line>
            </svg>
            <span>FILTROS</span>
        </div>
    </div>
    <div class="coluna-header">TIPO</div>
    <div class="coluna-header">CARGA HORÁRIA</div>
    <div class="coluna-header">REMUNERAÇÃO</div>
    <div class="coluna-header">HORAS COMP.</div>
    <div></div> </nav>

<div class="overlay" id="overlay"></div>

<div class="filter-modal" id="filterModal">
    <div class="filter-modal-header">
        <h2>Filtros</h2>
        <div class="close-filter" id="closeFilter">✖</div>
    </div>

    <div class="filter-content">
        <div class="filter-column">
            <h3>TIPO</h3>
            <label><input type="checkbox"> Monitoria</label>
            <label><input type="checkbox"> Estágio</label>
            <label><input type="checkbox"> Iniciação Científica</label>
            <label><input type="checkbox"> Trabalho Meio Período</label>
            <label><input type="checkbox"> Voluntariado</label>
            <label><input type="checkbox"> Palestra</label>
            <label><input type="checkbox"> Equipe de Competição</label>
            <label><input type="checkbox"> Bolsa</label>
        </div>

        <div class="filter-column">
            <h3>CARGA HORÁRIA</h3>
            <label><input type="checkbox"> &lt; 2 horas /dia</label>
            <label><input type="checkbox"> &gt; 2 horas /dia</label>
            <label><input type="checkbox"> &gt; 4 horas /dia</label>
            <label><input type="checkbox"> &gt; 6 horas /dia</label>
            <label><input type="checkbox"> &gt; 8 horas /dia</label>
        </div>

        <div class="filter-column">
            <h3>REMUNERAÇÃO</h3>
            <input type="range">
        </div>

        <div class="filter-column">
            <h3>HORAS COMP.</h3>
            <input type="range">
        </div>

        <div class="filter-column">
            <h3>INTERESSES</h3>
            <label><input type="checkbox"> Meus interesses</label>
            <label><input type="checkbox"> Tudo</label>
        </div>
    </div>
</div>

<main class="feed" id="conteudo" role="main">
    {% for oportunidade in oportunidades %}
    <section class="oportunidade-item">
        
        <div class="oportunidade-col bookmark-col">
            <svg class="bookmark-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
            </svg>
        </div>

        <div class="oportunidade-col info-col">
            <div class="info-imagem" style="background-image: url('https://via.placeholder.com/60x60/333/666?text={{ oportunidade.titulo|slice:":1" }}');"></div>
            <div class="info-texto">
                <h3>{{ oportunidade.titulo }}</h3>
                <p>{{ oportunidade.area }}</p>
            </div>
        </div>

        <div class="oportunidade-col">{{ oportunidade.get_tipo_display }}</div>
        <div class="oportunidade-col">{{ oportunidade.carga_horaria }}</div>
        <div class="oportunidade-col">R$ {{ oportunidade.remuneracao }}</div>
        <div class="oportunidade-col">{{ oportunidade.horas_complementares }}h</div>

        <div class="oportunidade-col acao-col">
            <a href="{% url 'detalhe_oportunidade' oportunidade.id %}" class="btn-ver-mais">
                Ver mais
            </a>
        </div>

    </section>
    {% empty %}
        <p style="text-align: center; padding: 40px; color: #99a8bd;">Nenhuma oportunidade encontrada.</p>
    {% endfor %}
</main>
{% endblock %}

{% block extra_js %}
<script>
    // Seletores
    const filtrosToggle = document.getElementById("filtrosToggle");
    const overlay = document.getElementById("overlay");
    const filterModal = document.getElementById("filterModal");
    const closeFilter = document.getElementById("closeFilter");

    function openFilterModal() {
        if(overlay && filterModal) {
            overlay.style.display = "block";
            filterModal.style.display = "block";
            document.body.style.overflow = "hidden";
        }
    }

    function closeFilterModal() {
        if(overlay && filterModal) {
            overlay.style.display = "none";
            filterModal.style.display = "none";
            document.body.style.overflow = "";
        }
    }

    // Event listeners
    if (filtrosToggle) filtrosToggle.addEventListener('click', openFilterModal);
    if (closeFilter) closeFilter.addEventListener('click', closeFilterModal);
    if (overlay) overlay.addEventListener('click', closeFilterModal);

    // Fechar com ESC
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape' && overlay && overlay.style.display === 'block') {
            closeFilterModal();
        }
    });
</script>
{% endblock %}