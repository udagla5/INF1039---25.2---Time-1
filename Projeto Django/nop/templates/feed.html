{% extends 'base.html' %}
{% load static %}

{% block title %}Feed | NOP{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/filtros.css' %}" />
<link rel="stylesheet" href="{% static 'css/feed.css' %}" />
{% endblock %}

{% block content %}
<!-- BARRA DE FILTROS -->
<nav class="barra-principal" role="navigation" aria-label="Menu principal">
    <div class="filtros-area">
        <div class="filtros-toggle" id="filtrosToggle">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="4" y1="12" x2="20" y2="12"></line>
                <line x1="4" y1="6" x2="20" y2="6"></line>
                <line x1="4" y1="18" x2="20" y2="18"></line>
            </svg>
            <span>FILTROS</span>
        </div>
    </div>
    <div class="coluna-header">TIPO</div>
    <div class="coluna-header">CARGA HOR√ÅRIA</div>
    <div class="coluna-header">REMUNERA√á√ÉO</div>
    <div class="coluna-header">HORAS COMPLEMENTARES</div>
    <div></div>
</nav>

<!-- POPUP DE FILTROS -->
<div class="overlay" id="overlay"></div>

<div class="filter-modal" id="filterModal">
    <div class="filter-modal-header">
        <h2>Filtros</h2>
        <div class="close-filter" id="closeFilter">‚úñ</div>
    </div>

    <div class="filter-content">
        <div class="filter-column">
            <h3>TIPO</h3>
            <label><input type="checkbox"> Monitoria</label>
            <label><input type="checkbox"> Est√°gio</label>
            <label><input type="checkbox"> Inicia√ß√£o Cient√≠fica</label>
            <label><input type="checkbox"> Trabalho Meio Per√≠odo</label>
            <label><input type="checkbox"> Voluntariado</label>
            <label><input type="checkbox"> Palestra</label>
            <label><input type="checkbox"> Equipe de Competi√ß√£o</label>
            <label><input type="checkbox"> Bolsa</label>
        </div>

        <div class="filter-column">
            <h3>CARGA HOR√ÅRIA</h3>
            <label><input type="checkbox"> &lt; 2 horas /dia</label>
            <label><input type="checkbox"> &gt; 2 horas /dia</label>
            <label><input type="checkbox"> &gt; 4 horas /dia</label>
            <label><input type="checkbox"> &gt; 6 horas /dia</label>
            <label><input type="checkbox"> &gt; 8 horas /dia</label>
        </div>

        <div class="filter-column">
            <h3>REMUNERA√á√ÉO</h3>
            <input type="range">
        </div>

        <div class="filter-column">
            <h3>HORAS COMP.</h3>
            <input type="range">
        </div>

        <div class="filter-column">
            <h3>INTERESSES</h3>
            <label><input type="checkbox"> Meus interesses</label>
            <label><input type="checkbox"> Tudo</label>
        </div>
    </div>
</div>

<!-- FEED DE OPORTUNIDADES -->
<main class="feed" id="conteudo" role="main">
    {% for oportunidade in oportunidades %}
    <section class="oportunidade-item">
        <div class="oportunidade-col bookmark-col">
            <svg class="bookmark-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
            </svg>
        </div>
        <div class="oportunidade-col info-col">
            <div class="info-imagem" style="background-image: url('https://via.placeholder.com/60x60/80A9FF/FFFFFF?text=üß†');"></div>
            <div class="info-texto">
                <h3>{{oportunidade.titulo}}</h3>
                <p>{{oportunidade.area}}</p>s
            </div>
        </div>
        <div class="oportunidade-col">{{oportunidade.tipo}}</div>
        <div class="oportunidade-col">{{oportunidade.carga_horaria}}</div>
        <div class="oportunidade-col">{{oportunidade.remuneracao}}</div>
        <div class="oportunidade-col">{{oportunidade.horas_complementares}}</div>
        <div class="oportunidade-col compatibilidade-col">
            <span class="status-texto">Compat√≠vel</span>
            <svg class="check-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#28a745" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        </div>
    </section>
    {% endfor %}
</main>
{% endblock %}

{% block extra_js %}
<script>
    // Seletores mais espec√≠ficos
    const filtrosToggle = document.getElementById("filtrosToggle");
    const overlay = document.getElementById("overlay");
    const filterModal = document.getElementById("filterModal");
    const closeFilter = document.getElementById("closeFilter");

    console.log("Elementos encontrados:", {
        filtrosToggle: !!filtrosToggle,
        overlay: !!overlay,
        filterModal: !!filterModal,
        closeFilter: !!closeFilter
    });

    function openFilterModal() {
        console.log("Abrindo modal...");
        overlay.style.display = "block";
        filterModal.style.display = "block";
        document.body.style.overflow = "hidden";
    }

    function closeFilterModal() {
        console.log("Fechando modal...");
        overlay.style.display = "none";
        filterModal.style.display = "none";
        document.body.style.overflow = "";
    }

    // Event listeners
    if (filtrosToggle) {
        filtrosToggle.addEventListener('click', openFilterModal);
    } else {
        console.error("Bot√£o de filtros n√£o encontrado!");
    }

    if (closeFilter) {
        closeFilter.addEventListener('click', closeFilterModal);
    }

    if (overlay) {
        overlay.addEventListener('click', closeFilterModal);
    }

    // Fechar com ESC
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape' && overlay.style.display === 'block') {
            closeFilterModal();
        }
    });

    // Prevenir que cliques dentro do modal fechem ele
    if (filterModal) {
        filterModal.addEventListener('click', function(event) {
            event.stopPropagation();
        });
    }
</script>
{% endblock %}