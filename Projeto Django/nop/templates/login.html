{% extends 'base.html' %}
{% load static %}

{% block title %}Login | NOP{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/login.css' %}">
<link rel="stylesheet" href="{% static 'css/messages.css' %}">

<style>
/* * Este CSS injetado garante que o conte√∫do do 'block content' (main-content) 
 * centralize o card sem ocultar o header. 
 */
.main-content {
    /* O main-content √© definido no base.html como flex: 1; display: flex; flex-direction: column; */
    /* Vamos us√°-lo para centralizar o CARD: */
    align-items: center; /* Centraliza horizontalmente o div.page */
    justify-content: center; /* Centraliza verticalmente o conte√∫do (se houver espa√ßo) */
    flex-grow: 1; /* Garante que ocupe todo o espa√ßo vertical dispon√≠vel */
    padding-top: 50px; /* Adiciona um respiro entre o header e o card */
    padding-bottom: 50px;
    background-color: var(--primary-dark); /* Garante que o fundo sob o header seja escuro */
}

/* O body tem height: 100% e flex-direction: column em base.css */
/* O body agora vai ocupar 100% da altura da viewport */
body {
    min-height: 100vh;
}
</style>
{% endblock %}

{% block content %}
  {# O messages-floating √© tratado globalmente no base.html, n√£o √© necess√°rio aqui. #}
  
  <div class="page">
    <img class="logo" src="{% static 'img/logo-grande.png' %}" alt="NOP Logo" onerror="this.style.display='none'">

    <main class="card">
      <h1 class="title">
          Entrar na sua conta 
          <img src="{% static 'img/logo-pequena.png' %}" alt="Logo" height="20" onerror="this.style.display='none'">
      </h1>
      <p class="subtitle">Todas as oportunidades da PUC-Rio reunidas aqui</p>

      <form method="post">
        {% csrf_token %}

        <label for="{{ form.username.id_for_label }}">Usu√°rio</label>
        {{ form.username }}
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
          <label for="{{ form.password.id_for_label }}">Senha</label>
          <a href="#">Esqueceu a senha?</a>
        </div>
        
        <div class="pwd-wrap">
          {{ form.password }}
          <button class="eye-btn" type="button" aria-label="Mostrar senha">üëÅÔ∏è</button>
        </div>

        <input type="hidden" name="next" value="{{ request.GET.next }}">
        
        <button class="enter-btn" type="submit">Entrar</button>
      </form>

      <div style="height: 1px; background: #eee; margin: 20px 0;"></div>

      <p style="text-align: center; color: #666; font-size: 0.9rem;">
          N√£o tem uma conta? <a href="{% url 'cadastro1' %}">Criar conta</a>
      </p>
      
      <button type="button" onclick="window.location.href='{% url 'home' %}'">
          Voltar para a p√°gina inicial
      </button>
    </main>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
          const eyeBtn = document.querySelector(".eye-btn");
          // Usa o atributo 'type' para ser mais robusto, j√° que id/class s√£o controlados pelo Django Forms
          const passwordInput = document.querySelector('input[type="password"]'); 

          if (eyeBtn && passwordInput) {
              eyeBtn.addEventListener("click", function () {
                  if (passwordInput.type === "password") {
                      passwordInput.type = "text";
                      eyeBtn.textContent = "üôà"; 
                  } else {
                      passwordInput.type = "password";
                      eyeBtn.textContent = "üëÅÔ∏è";
                  }
              });
          } else {
              console.warn("Elemento de senha ou bot√£o de olho n√£o encontrado.");
          }
      });
    </script>
  </div>

{% endblock %}